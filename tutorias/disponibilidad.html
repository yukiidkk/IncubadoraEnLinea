<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tutorías - Coordinador</title>
    <link rel="stylesheet" href="css/disponibilidad.css">
</head>
<body>
    <!-- ENCABEZADO -->
    <header class="header">
        <div class="logo">
            <img src="../images/logoITS.png" alt="Logo" class="logo-img">
            <span>Instituto Tecnológico de Saltillo</span>
        </div>
        <nav class="nav">
            <a href="../inicioC.html">Inicio</a>
            <a href="../gestionUsuarios.html">Usuarios</a>
            <a href="../roles.html">Roles</a>
            <a href="../proyectos.html">Proyectos</a>
            <a href="../reportes.html">Reportes</a>
            <a href="../eventos.html">Eventos</a>
            <a href="tutorias.html">Tutorias</a>
        </nav>
        <div class="usuario">
            <span>Coordinador</span>
            <img src="../images/user-icon.png" alt="usuario" class="usuario-img" width="25" height="25">
        </div>
    </header>

    <!-- CONTENEDOR PRINCIPAL -->
    <div class="container">
        <!-- MENÚ LATERAL -->
        <aside class="sidebar">
            <h3>Menú</h3>
            <ul>
                <li><a href="tutorias.html">Agenda</a></li>
                <li><a href="#" class="active">Disponibilidad</a></li>
                <li><a href="historial.html">Historial</a></li>
            </ul>
        </aside>

        <!-- CONTENIDO PRINCIPAL -->
        <main class="main">
            <h2>Tutorías</h2>
            <h3>Disponibilidad</h3>

            <!-- CONTENEDOR DE CALENDARIO Y FORMULARIO -->
            <div class="content-wrapper">
                <!-- CALENDARIO -->
                <div class="calendario-container">
                    <div class="calendar">
                        <input type="month" id="mes" value="2023-01">
                        <div class="calendar-box">
                            <table>
                                <thead>
                                    <tr>
                                        <th>Dom</th>
                                        <th>Lun</th>
                                        <th>Mar</th>
                                        <th>Mie</th>
                                        <th>Jue</th>
                                        <th>Vie</th>
                                        <th>Sab</th>
                                    </tr>
                                </thead>
                                <tbody id="calendar-body"></tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- FORMULARIO MODIFICADO -->
                <div class="form-section">
                    <div class="form-group">
                        <label>Día</label>
                        <select id="dia">
                            <option value="">Seleccione un día</option>
                            <option value="Lunes">Lunes</option>
                            <option value="Martes">Martes</option>
                            <option value="Miércoles">Miércoles</option>
                            <option value="Jueves">Jueves</option>
                            <option value="Viernes">Viernes</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label>Tutor</label>
                        <select id="tutor">
                            <option value="">Seleccione un tutor</option>
                            <option value="Tutor 1">Tutor 1</option>
                            <option value="Tutor 2">Tutor 2</option>
                            <option value="Tutor 3">Tutor 3</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label>Hora</label>
                        <select id="hora">
                            <option value="">Seleccione una hora</option>
                            <option value="08:00">08:00</option>
                            <option value="09:00">09:00</option>
                            <option value="10:00">10:00</option>
                            <option value="11:00">11:00</option>
                            <option value="12:00">12:00</option>
                            <option value="13:00">13:00</option>
                            <option value="14:00">14:00</option>
                            <option value="15:00">15:00</option>
                            <option value="16:00">16:00</option>
                        </select>
                    </div>

                    <div class="buttons">
                        <button class="btn registrar">Registrar</button>
                        <button class="btn actualizar">Actualizar</button>
                        <button class="btn eliminar">Eliminar</button>
                    </div>
                </div>
            </div>
        </main>
    </div>
<script>
        const API_URL = "http://localhost:3001/api/tutorias";

        //Cargar tutores
        async function cargarTutores() {
            const comboTutor = document.getElementById("tutor");
            comboTutor.innerHTML = `<option value="">Seleccione un tutor</option>`;

            try {
                const res = await fetch(`${API_URL}/tutores`);
                const tutores = await res.json();

                tutores.forEach(t => {
                    const option = document.createElement("option");
                    option.value = t.id_usuario;
                    option.textContent = t.nombre_completo;
                    comboTutor.appendChild(option);
                });

            } catch (error) {
                console.error("Error al cargar tutores:", error);
            }
        }

        cargarTutores();



        //Calendario
        const monthInput = document.getElementById("mes");
        const calendarBody = document.getElementById("calendar-body");

        function generarCalendario(year, month) {
            calendarBody.innerHTML = "";
            const firstDay = new Date(year, month, 1).getDay();
            const lastDate = new Date(year, month + 1, 0).getDate();
            let date = 1;

            for (let i = 0; i < 6; i++) {
                const row = document.createElement("tr");
                for (let j = 0; j < 7; j++) {
                    const cell = document.createElement("td");
                    if (i === 0 && j < firstDay) {
                        cell.classList.add("empty");
                        row.appendChild(cell);
                    } else if (date > lastDate) {
                        cell.classList.add("empty");
                        row.appendChild(cell);
                    } else {
                        cell.textContent = date;
                        cell.addEventListener("click", () => seleccionarFecha(cell));
                        row.appendChild(cell);
                        date++;
                    }
                }
                calendarBody.appendChild(row);
            }
        }

        function seleccionarFecha(cell) {
            document.querySelectorAll("td").forEach(td => td.classList.remove("selected"));
            cell.classList.add("selected");
        }

        monthInput.addEventListener("change", () => {
            const [year, month] = monthInput.value.split("-").map(Number);
            generarCalendario(year, month - 1);
        });

        const [initYear, initMonth] = monthInput.value.split("-").map(Number);
        generarCalendario(initYear, initMonth - 1);
    </script>
</body>
</html>
